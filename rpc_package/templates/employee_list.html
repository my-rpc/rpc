{% extends "page_layout/layout.html" %}

{% block title %} {{ super() }} Add New Employee {% endblock %}
{% block css_or_js_code %}
    <!-- add js, css code or library as need. js code is recommended in at footer 
        This code will be add to the head of the page
    -->
    <link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs4/jszip-2.5.0/dt-1.10.25/b-1.7.1/b-colvis-1.7.1/b-html5-1.7.1/b-print-1.7.1/date-1.1.0/r-2.2.9/sb-1.1.0/sl-1.3.3/datatables.min.css"/>
{% endblock  css_or_js_code %}
{% block main_content %}
<!-- main content code will be add here -->
<div class="box">
    <div class="box-header"><h4 class="box-title text-primary font-weight-bold ">Employee List</h4></div>
    <div class="box-body">
        <table id="create_new_employee_table" class="table table-striped table-bordered" style="width:100%">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Position</th>
                    <th>Office</th>
                    <th>Age</th>
                    <th>Start date</th>
                    <th>Salary</th>
                    <th>operation</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Tiger Nixon</td>
                    <td>System Architect</td>
                    <td>Edinburgh</td>
                    <td>61</td>
                    <td>2011/04/25</td>
                    <td>$320,800</td>
                    <td><span><i class="fad fa-times text-danger"></i></span><span class="px-4 text-secondary font-weight-bolder">|</span><span><i class="fad fa-edit text-info"></i></span></td>
                </tr>
                <tr>
                    <td>Garrett Winters</td>
                    <td>Accountant</td>
                    <td>Tokyo</td>
                    <td>63</td>
                    <td>2011/07/25</td>
                    <td>$170,750</td>
                    <td><span><i class="fad fa-times text-danger"></i></span><span class="px-4 text-secondary font-weight-bolder">|</span><span><i class="fad fa-edit text-info"></i></span></td>
                </tr>
                <tr>
                    <td>Ashton Cox</td>
                    <td>Junior Technical Author</td>
                    <td>San Francisco</td>
                    <td>66</td>
                    <td>2009/01/12</td>
                    <td>$86,000</td>
                    <td><span><i class="fad fa-times text-danger"></i></span><span class="px-4 text-secondary font-weight-bolder">|</span><span><i class="fad fa-edit text-info"></i></span></td>
                </tr>
                <tr>
                    <td>Cedric Kelly</td>
                    <td>Senior Javascript Developer</td>
                    <td>Edinburgh</td>
                    <td>22</td>
                    <td>2012/03/29</td>
                    <td>$433,060</td>
                    <td><span><i class="fad fa-times text-danger"></i></span><span class="px-4 text-secondary font-weight-bolder">|</span><span><i class="fad fa-edit text-info"></i></span></td>
                </tr>
                <tr>
                    <td>Airi Satou</td>
                    <td>Accountant</td>
                    <td>Tokyo</td>
                    <td>33</td>
                    <td>2008/11/28</td>
                    <td>$162,700</td>
                    <td><span><i class="fad fa-times text-danger"></i></span><span class="px-4 text-secondary font-weight-bolder">|</span><span><i class="fad fa-edit text-info"></i></span></td>
                </tr>
                <tr>
                    <td>Brielle Williamson</td>
                    <td>Integration Specialist</td>
                    <td>New York</td>
                    <td>61</td>
                    <td>2012/12/02</td>
                    <td>$372,000</td>
                    <td><span><i class="fad fa-times text-danger"></i></span><span class="px-4 text-secondary font-weight-bolder">|</span><span><i class="fad fa-edit text-info"></i></span></td>
                </tr>
                
            </tbody>
            <tfoot>
                <tr>
                    <th>Name</th>
                    <th>Position</th>
                    <th>Office</th>
                    <th>Age</th>
                    <th>Start date</th>
                    <th>Salary</th>
                </tr>
            </tfoot>
        </table>
    </div>
</div>
<div class="modal fade create_new_employee_modal" tabindex="-1" role="dialog" aria-labelledby="myLargeModalLabel" aria-hidden="true" style="display: none;">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title text-primary" id="myLargeModalLabel">
                    {{translation.create_new_user[language]}}
                </h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
            </div>
            <div class="modal-body">
                <!--   Action="" is used to confirm to route to the same page.     -->
                <form method="POST", action="" id="add_employee">
                    {{ form.hidden_tag()}}
                    <fieldset class="form-group">
                        <div class="form-group">
                            {{ form.employee_id.label(class="form-control-label")}}
                            {{ form.employee_id(class="form-control form-control-lg")}}
                        </div>
                        <div class="form-group">
                            <legend class="border-bottom mb-4">
                              {{  translation.name_language['dari'] }}
                          </legend>
                            {{ form.first_name.label(class="form-control-label")}}
                            {{ form.first_name(class="form-control form-control-lg")}}
                        </div>
                        <div class="form-group">
                            {{ form.last_name.label(class="form-control-label")}}
                            {{ form.last_name(class="form-control form-control-lg")}}
                        </div>
                        <div class="form-group">
                            {{ form.father_name.label(class="form-control-label")}}
                            {{ form.father_name(class="form-control form-control-lg")}}
                        </div>
                        <div class="form-group">
                            {{ form.grand_name.label(class="form-control-label")}}
                            {{ form.grand_name(class="form-control form-control-lg")}}
                        </div>
          
                        <div class="form-group">
                            <legend class="border-bottom mb-4">
                              {{  translation.name_language['en'] }}
                            </legend>
                            {{ form.first_name_english.label(class="form-control-label")}}
                            {{ form.first_name_english(class="form-control form-control-lg")}}
                        </div>
                        <div class="form-group">
                            {{ form.last_name_english.label(class="form-control-label")}}
                            {{ form.last_name_english(class="form-control form-control-lg")}}
                        </div>
                        <div class="form-group">
                            {{ form.father_name_english.label(class="form-control-label")}}
                            {{ form.father_name_english(class="form-control form-control-lg")}}
                        </div>
                        <div class="form-group">
                            {{ form.grand_name_english.label(class="form-control-label")}}
                            {{ form.grand_name_english(class="form-control form-control-lg")}}
                        </div>
                        <div class="form-group">
                            {{ form.birthday.label(class="form-control-label")}}
                            {{ form.birthday(class="form-control form-control-lg")}}
                        </div>
                        <div class="form-group">
                            {{ form.tazkira.label(class="form-control-label")}}
                            {{ form.tazkira(class="form-control form-control-lg")}}
                        </div>
                        <div class="form-group">
                            <div class="form-check1">
                              {% for radio in form.gender %}
                                  {{ radio(class="form-check-input")}}
                                  {{ radio.label(class="form-check-label")}}
                              {% endfor %}
                            </div>
                        </div>
                         <div class="form-group">
                            {{ form.blood.label(class="form-control-label")}}
                            {{ form.blood(class="form-control form-control-lg")}}
                        </div>
                        <div class="form-group">
                            <div class="form-check1">
                              {% for radio in form.m_status %}
                                  {{ radio(class="form-check-input")}}
                                  {{ radio.label(class="form-check-label")}}
                              {% endfor %}
                            </div>
                        </div>
                        <div class="form-group">
                            {{ form.tin.label(class="form-control-label")}}
                            {{ form.tin(class="form-control form-control-lg")}}
                        </div>
          
          
                    </fieldset>
                    <div class="form-group">
                        {{form.submit(class="btn btn-primary")}}
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-danger text-left" data-dismiss="modal">Close</button>
            </div>
        </div>
        <!-- /.modal-content -->
    </div>
    <!-- /.modal-dialog -->
</div>
<!-- /.modal -->
{% endblock main_content%}
{% block js_code %}
    <!-- 
        add js code or library here as needed 
        This code will be add to the footer of the page
    -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/pdfmake.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.36/vfs_fonts.js"></script>
    <script type="text/javascript" src="https://cdn.datatables.net/v/bs4/jszip-2.5.0/dt-1.10.25/b-1.7.1/b-colvis-1.7.1/b-html5-1.7.1/b-print-1.7.1/date-1.1.0/r-2.2.9/sb-1.1.0/sl-1.3.3/datatables.min.js"></script>

    <script src="{{url_for('static', filename='assets/vendor_components/jquery-toast-plugin-master/src/jquery.toast.js')}}"></script>
    <script src="{{url_for('static', filename='js/rpc.js')}}"></script>
    <script>

$(document).ready(function() {
    $('#create_new_employee_table').DataTable({
        dom: 'Bfrtip',
        buttons: [
            'colvis',
            'excel',
            'print',
            {
            text: '<i class="fad fa-plus"></i> Add New Employee',
            attr: {'class': 'btn btn-primary'},
            action: function () {
                $('.create_new_employee_modal').modal('show')
            }
        }
        ],
    }
    );
});

        $(document).on( 'submit', '#add_employee', function(e){
            e.preventDefault();
            $form = $(this);
            var formData = new FormData($form[0]);
            $.ajax({
                type: "POST",
                url: "/add_employee",
                data: formData,
                processData: false,
                contentType: false,
                success: function (response) {
                    toastSuccess(response);
                },error: function(response){
                    var statusCode = response.status;
                    var r = '';
                    if(statusCode == '403'){
                        r = formValidateErrors(response);
                    }
                    toastError(r);
                }
            });
        });
    </script>
{% endblock js_code %}