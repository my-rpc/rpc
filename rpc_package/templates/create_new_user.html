{% extends "page_layout/layout.html" %}

{% block title %} {{ super() }} login {% endblock %}
{% block css_or_js_code %}
    <!-- add js, css code or library as need. js code is recommended in at footer 
        This code will be add to the head of the page
    -->

{% endblock  css_or_js_code %}
{% block main_content %}
<!-- main content code will be add here -->

<div class="box">
    <div class="box-header with-border">
      <h4 class="box-title">{{translation.create_new_user[language]}}</h4>
    </div>
    <div class="box-body">
    <!--   Action="" is used to confirm to route to the same page.     -->
      <form method="POST", action="" id="create_user">
          {{ form.hidden_tag()}}
          <fieldset class="form-group">
              <div class="form-group">
                  {{ form.employee_id.label(class="form-control-label")}}
                  {{ form.employee_id(class="form-control form-control-lg")}}
              </div>
              <div class="form-group">
                  {{ form.password.label(class="form-control-label")}}
                  {{ form.password(class="form-control form-control-lg")}}
                  

              </div>
              <div class="form-group">
                  {{ form.confirm_password.label(class="form-control-label")}}
                  {{ form.confirm_password(class="form-control form-control-lg")}}
                  
              </div>
              <div class="form-group">
                  {{ form.user_role.label(class="form-control-label")}}
                  {{ form.user_role(class="form-control form-control-lg")}}
                  
              </div>
          </fieldset>
          <div class="form-group">
              {{form.submit(class="btn btn-primary")}}
          </div>
          
      </form>
    </div>
{#    <!-- /.box-body -->#}
{#    <div class="box-footer">#}
{#      Footer#}
{#    </div>#}
{#    <!-- /.box-footer-->#}
</div>

{% endblock main_content%}
{% block js_code %}
    <!-- 
        add js code or library here as needed 
        This code will be add to the footer of the page
    -->
    <script src="{{url_for('static', filename='assets/vendor_components/jquery-toast-plugin-master/src/jquery.toast.js')}}"></script>
    <script src="{{url_for('static', filename='js/rpc.js')}}"></script>
    <script>
        $(document).on( 'submit', '#create_user', function(e){
            e.preventDefault();
            $form = $(this);
            var formData = new FormData($form[0]);
            $.ajax({
                type: "POST",
                url: "create_new_user",
                data: formData,
                processData: false,
                contentType: false,
                success: function (response) {
                    toastSuccess(response);
                },error: function(response){
                    var statusCode = response.status;
                    var r = '';
                    if(statusCode == '403'){
                        r = formValidateErrors(response);
                    }
                    toastError(r);
                }
            });
        });
    </script>
{% endblock js_code %}