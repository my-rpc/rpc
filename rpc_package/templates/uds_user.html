{% extends "page_layout/layout.html" %}

{% block title %} {{ super() }} ,User update {% endblock %}
{% block css_or_js_code %}
    <!-- add js, css code or library as need. js code is recommended in at footer 
        This code will be add to the head of the page
    -->

{% endblock  css_or_js_code %}
{% block main_content %}
<!-- main content code will be add here -->

<div class="box">
    <div class="box-header with-border">
      <h4 class="box-title">{{translation.create_new_user[language]}}</h4>
     
 
    <!--   Action="" is used to confirm to route to the same page.     -->
      <form method="POST", action="" id="create_user">
          {{ form.hidden_tag()}}
          <fieldset class="form-group">
              <div class="form-group">
                  {{ form.employee_id.label(class="form-control-label")}}

                  {% if form.employee_id.errors %}
                      {{ form.employee_id(class="form-control form-control-lg is-invalid")}}
                          <div class="invalid-feedback">
                            {% for error in form.employee_id.errors %}
                                <span>
                                    {{error}}
                                </span>
                            {% endfor %}
                          </div>
                  {% else %}
                      {{ form.employee_id(class="form-control form-control-lg")}}
                  {%  endif %}
              </div>
              <div class="form-group">
                  {{ form.password.label(class="form-control-label")}}

                  {% if form.password.errors %}
                      {{ form.password(class="form-control form-control-lg is-invalid")}}
                          <div class="invalid-feedback">
                            {% for error in form.password.errors %}
                                <span>
                                    {{error}}
                                </span>
                            {% endfor %}
                          </div>
                  {% else %}
                      {{ form.password(class="form-control form-control-lg")}}
                  {%  endif %}

              </div>
              <div class="form-group">
                  {{ form.confirm_password.label(class="form-control-label")}}

                  {% if form.confirm_password.errors %}
                      {{ form.confirm_password(class="form-control form-control-lg is-invalid")}}
                          <div class="invalid-feedback">
                            {% for error in form.confirm_password.errors %}
                                <span>
                                    {{error}}
                                </span>
                            {% endfor %}
                          </div>
                  {% else %}
                      {{ form.confirm_password(class="form-control form-control-lg")}}
                  {%  endif %}
              </div>
              <div class="form-group">
                  {{ form.user_role.label(class="form-control-label")}}

                  {% if form.user_role.errors %}
                      {{ form.user_role(class="form-control form-control-lg is-invalid")}}
                          <div class="invalid-feedback">
                            {% for error in form.user_role.errors %}
                                <span>
                                    {{error}}
                                </span>
                            {% endfor %}
                          </div>
                  {% else %}
                      {{ form.user_role(class="form-control form-control-lg")}}
                  {%  endif %}
              </div>
          </fieldset>
          <div class="form-group">
              {{form.submit(class="btn btn-primary")}}
          </div>
          
      </form>
    </div>
{#    <!-- /.box-body -->#}
{#    <div class="box-footer">#}
{#      Footer#}
{#    </div>#}
{#    <!-- /.box-footer-->#}
</div>

{% endblock main_content%}
{% block js_code %}
    <!-- 
        add js code or library here as needed 
        This code will be add to the footer of the page
    -->
    <script src="{{url_for('static', filename='assets/vendor_components/jquery-toast-plugin-master/src/jquery.toast.js')}}"></script>
    <script src="{{url_for('static', filename='js/rpc.js')}}"></script>
    <script>
        $(document).on( 'submit', '#Search_user', function(e){
            e.preventDefault();
            $form = $(this);
            var formData = new FormData($form[0]);
            $.ajax({
                type: "POST",
                url: "create_new_user",
                data: formData,
                processData: false,
                contentType: false,
                success: function (response) {
                    console.log(response)
                    
                    $.toast({
                        heading: 'Success',
                        text: response.message,
                        position: 'top-right',
                        loaderBg: '#ff6849',
                        icon: 'success',
                        hideAfter: 5500,
                        stack: 6
                    });

                },error: function(response){
                    $.toast({
                        heading: 'Error',
                        text: formValidateErrors(response),
                        position: 'top-right',
                        loaderBg: '#ff6849',
                        icon: 'warning',
                        hideAfter: 6000,
                        stack: 6
                    });
                    // console.log(response)
                }
            });
        });
    </script>
{% endblock js_code %}
